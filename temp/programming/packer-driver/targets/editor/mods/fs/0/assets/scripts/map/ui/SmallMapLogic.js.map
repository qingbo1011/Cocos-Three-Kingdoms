{"version":3,"sources":["file:///D:/git/github/mszlu/games/slg/ms-sg/assets/scripts/map/ui/SmallMapLogic.ts"],"names":["_decorator","Component","EditBox","MapCommand","MapUtil","EventMgr","ccclass","property","SmallMapLogic","onLoad","on","onMapCenterChange","onScrollToMap","updateView","onDestroy","targetOff","centerPoint","getInstance","proxy","getCurCenterPoint","editBoxX","string","x","toString","editBoxY","y","onClickJump","Number","mapSize","width","height","emit","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,O,OAAAA,O;;AAGzBC,MAAAA,U;;AACAC,MAAAA,O;;AACEC,MAAAA,Q,iBAAAA,Q;;;;;;;OAJH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;yBAOTQ,a,WADpBF,OAAO,CAAC,eAAD,C,UAEHC,QAAQ,CAACL,OAAD,C,UAERK,QAAQ,CAACL,OAAD,C,oCAJb,MACqBM,aADrB,SAC2CP,SAD3C,CACqD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,0CAMtB,EANsB;;AAAA,0CAOtB,EAPsB;AAAA;;AASvCQ,QAAAA,MAAM,GAAS;AACrB;AAAA;AAAA,oCAASC,EAAT,CAAY,mBAAZ,EAAiC,KAAKC,iBAAtC,EAAyD,IAAzD;AACA;AAAA;AAAA,oCAASD,EAAT,CAAY,eAAZ,EAA6B,KAAKE,aAAlC,EAAiD,IAAjD;AACA,eAAKC,UAAL;AACH;;AAESC,QAAAA,SAAS,GAAS;AACxB;AAAA;AAAA,oCAASC,SAAT,CAAmB,IAAnB;AACH;;AAESF,QAAAA,UAAU,GAAG;AACnB,cAAIG,WAAgB,GAAG;AAAA;AAAA,wCAAWC,WAAX,GAAyBC,KAAzB,CAA+BC,iBAA/B,EAAvB;;AACA,cAAIH,WAAJ,EAAiB;AACb,iBAAKI,QAAL,CAAcC,MAAd,GAAuBL,WAAW,CAACM,CAAZ,CAAcC,QAAd,EAAvB;AACA,iBAAKC,QAAL,CAAcH,MAAd,GAAuBL,WAAW,CAACS,CAAZ,CAAcF,QAAd,EAAvB;AACH;AACJ;;AAESZ,QAAAA,iBAAiB,GAAS;AAChC,eAAKE,UAAL;AACH;;AAESD,QAAAA,aAAa,GAAQ;AAC3B,eAAKC,UAAL;AACH;;AAEDa,QAAAA,WAAW,GAAS;AAChB,cAAIJ,CAAS,GAAGK,MAAM,CAAC,KAAKP,QAAL,CAAcC,MAAf,CAAtB;AACA,cAAII,CAAS,GAAGE,MAAM,CAAC,KAAKH,QAAL,CAAcH,MAAf,CAAtB;;AACA,cAAIC,CAAC,IAAI,CAAL,IACGG,CAAC,IAAI,CADR,IAEGH,CAAC,GAAG;AAAA;AAAA,kCAAQM,OAAR,CAAgBC,KAFvB,IAGGJ,CAAC,GAAG;AAAA;AAAA,kCAAQG,OAAR,CAAgBE,MAH3B,EAGmC;AAC3B;AAAA;AAAA,sCAASC,IAAT,CAAc,eAAd,EAA+BT,CAA/B,EAAkCG,CAAlC;AACP,WALD,MAKO;AACHO,YAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBX,CAAtB,EAAyBG,CAAzB;AACH;AACJ;;AA9CgD,O;;;;;iBAE7B,I;;;;;;;iBAEA,I","sourcesContent":["import { _decorator, Component, EditBox, Node, Vec2 } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport MapCommand from \"../MapCommand\";\nimport MapUtil from \"../MapUtil\";\nimport { EventMgr } from '../../utils/EventMgr';\n\n@ccclass('SmallMapLogic')\nexport default class SmallMapLogic extends Component {\n    @property(EditBox)\n    editBoxX: EditBox = null;\n    @property(EditBox)\n    editBoxY: EditBox = null;\n\n    protected _armys: Node[] = [];\n    protected _citys: Node[] = [];\n\n    protected onLoad(): void {\n        EventMgr.on(\"map_center_change\", this.onMapCenterChange, this);\n        EventMgr.on(\"scroll_to_map\", this.onScrollToMap, this);\n        this.updateView();\n    }\n\n    protected onDestroy(): void {\n        EventMgr.targetOff(this);\n    }\n\n    protected updateView() {\n        let centerPoint:Vec2 = MapCommand.getInstance().proxy.getCurCenterPoint();\n        if (centerPoint) {\n            this.editBoxX.string = centerPoint.x.toString();\n            this.editBoxY.string = centerPoint.y.toString();\n        }\n    }\n\n    protected onMapCenterChange(): void {\n        this.updateView();\n    }\n\n    protected onScrollToMap():void {\n        this.updateView();\n    }\n\n    onClickJump(): void {\n        let x: number = Number(this.editBoxX.string);\n        let y: number = Number(this.editBoxY.string);\n        if (x >= 0 \n            && y >= 0 \n            && x < MapUtil.mapSize.width \n            && y < MapUtil.mapSize.height) {\n                EventMgr.emit(\"scroll_to_map\", x, y);\n        } else {\n            console.log(\"跳转无效位置\", x, y);\n        }\n    }\n}\n"]}