{"version":3,"sources":["file:///D:/git/github/mszlu/games/slg/ms-sg/assets/scripts/map/ui/MapUILogic.ts"],"names":["_decorator","Component","Prefab","Node","Layout","Label","instantiate","LoginCommand","ArmySelectNodeLogic","CityArmySettingLogic","FacilityListLogic","MapUICommand","Dialog","UnionCommand","MapCommand","FortressAbout","CityAboutLogic","GeneralListLogic","TransformLogic","Tools","GeneralInfoLogic","WarReportLogic","DrawRLogic","SkillLogic","SkillInfoLogic","EventMgr","ccclass","property","MapUILogic","onLoad","_resArray","push","key","name","_yieldArray","on","openCityAbout","closeCityAbout","openFortressAbout","openFacility","openArmySetting","updateRoleRes","openGeneralDes","openGeneralChoose","onOpenArmySelectUI","openDrawR","robLoginUI","onCollection","onOpenGeneralConvert","onOpenGeneralRoster","openGeneral","onOpenSkill","onCloseSkill","onOpenSkillInfo","updateRole","unionId","getInstance","cityProxy","myUnionId","unionApplyList","showTip","emit","text","close","_dialogNode","dialog","parent","contentNode","active","setSiblingIndex","topLayer","getComponent","setClose","onDestroy","clearAllNode","proxy","clearData","targetOff","console","log","onBack","account_logout","_facilityNode","_generalNode","_cityAboutNode","_fortressAboutNode","_armySelectNode","_armySettingNode","_drawNode","_drawResultNode","_generalDesNode","children","length","data","facilityPrefab","setData","cityId","order","armySettingPrefab","type","position","zIndex","generalPrefab","cmd","x","y","armySelectPrefab","node","cfgData","curData","generalDesPrefab","cityAboutPrefab","widgetNode","fortressAboutPrefab","openWarReport","_warReportNode","warReportPrefab","updateView","srollLayout","roleRes","getRoleResData","i","getChildByName","string","numberToShow","index","obj","label","openDraw","drawPrefab","drawResultrefab","openUnion","_unionNode","unionPrefab","openChat","_chatNode","chatPrefab","openTr","_transFormNode","transFormPrefab","initView","_generalConvertNode","generalConvertPrefab","_generalRosterNode","generalRosterPrefab","onClickSkillBtn","general","skillPos","_skillNode","skillPrefab","cfg","_skillInfoNode","skillInfoPrefab","msg","gold","roleData","getRoleData","nameLabel","nickName","ridLabel","rid","onClickCollection","_collectNode","collectPrefab"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,W,OAAAA,W;;AAGtDC,MAAAA,Y;;AACAC,MAAAA,mB;;AACAC,MAAAA,oB;;AACAC,MAAAA,iB;;AACAC,MAAAA,Y;;AACAC,MAAAA,M;;AACAC,MAAAA,Y;;AACAC,MAAAA,U;;AACAC,MAAAA,a;;AACAC,MAAAA,c;;AACAC,MAAAA,gB;;AACAC,MAAAA,c;;AACEC,MAAAA,K,kBAAAA,K;;AACFC,MAAAA,gB;;AACAC,MAAAA,c;;AACAC,MAAAA,U;;AAEAC,MAAAA,U;;AAEAC,MAAAA,c;;AACEC,MAAAA,Q,kBAAAA,Q;;;;;;;OAtBH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwB3B,U;;yBA2BT4B,U,WADpBF,OAAO,CAAC,YAAD,C,UAGHC,QAAQ,CAACxB,IAAD,C,UAGRwB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,UAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAGRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAKRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACzB,MAAD,C,WAIRyB,QAAQ,CAACxB,IAAD,C,WAGRwB,QAAQ,CAACvB,MAAD,C,WAGRuB,QAAQ,CAACtB,KAAD,C,WAGRsB,QAAQ,CAACtB,KAAD,C,oCA3Fb,MACqBuB,UADrB,SACwC3B,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,iDAOd,IAPc;;AAAA;;AAAA,oDAWX,IAXW;;AAAA;;AAAA,+CAehB,IAfgB;;AAAA;;AAAA,gDAmBf,IAnBe;;AAAA;;AAAA,mDAuBZ,IAvBY;;AAAA;;AAAA,kDA2Bb,IA3Ba;;AAAA;;AAAA,sDA+BT,IA/BS;;AAAA;;AAAA,kDAmCb,IAnCa;;AAAA;;AAAA,mDAsCZ,IAtCY;;AAAA;;AAAA,6CA0ClB,IA1CkB;;AAAA;;AAAA,mDA8CZ,IA9CY;;AAAA;;AAAA,8CAkDjB,IAlDiB;;AAAA;;AAAA,6CAsDlB,IAtDkB;;AAAA;;AAAA,gDA0Df,IA1De;;AAAA;;AAAA,kDA+Db,IA/Da;;AAAA;;AAAA,uDAmER,IAnEQ;;AAAA;;AAAA,sDAuET,IAvES;;AAAA;;AAAA,8CA2EjB,IA3EiB;;AAAA;;AAAA,kDA+Eb,IA/Ea;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,6CA6FnB,EA7FmB;;AAAA,+CA8FjB,EA9FiB;AAAA;;AAgGpC4B,QAAAA,MAAM,GAAS;AAErB,eAAKC,SAAL,CAAeC,IAAf,CAAoB;AAACC,YAAAA,GAAG,EAAC,OAAL;AAAcC,YAAAA,IAAI,EAAC;AAAnB,WAApB;;AACA,eAAKH,SAAL,CAAeC,IAAf,CAAoB;AAACC,YAAAA,GAAG,EAAC,MAAL;AAAaC,YAAAA,IAAI,EAAC;AAAlB,WAApB;;AACA,eAAKH,SAAL,CAAeC,IAAf,CAAoB;AAACC,YAAAA,GAAG,EAAC,MAAL;AAAaC,YAAAA,IAAI,EAAC;AAAlB,WAApB;;AACA,eAAKH,SAAL,CAAeC,IAAf,CAAoB;AAACC,YAAAA,GAAG,EAAC,OAAL;AAAcC,YAAAA,IAAI,EAAC;AAAnB,WAApB;;AACA,eAAKH,SAAL,CAAeC,IAAf,CAAoB;AAACC,YAAAA,GAAG,EAAC,MAAL;AAAaC,YAAAA,IAAI,EAAC;AAAlB,WAApB;;AAEA,eAAKC,WAAL,CAAiBH,IAAjB,CAAsB;AAACC,YAAAA,GAAG,EAAC,YAAL;AAAmBC,YAAAA,IAAI,EAAC;AAAxB,WAAtB;;AACA,eAAKC,WAAL,CAAiBH,IAAjB,CAAsB;AAACC,YAAAA,GAAG,EAAC,YAAL;AAAmBC,YAAAA,IAAI,EAAC;AAAxB,WAAtB;;AACA,eAAKC,WAAL,CAAiBH,IAAjB,CAAsB;AAACC,YAAAA,GAAG,EAAC,aAAL;AAAoBC,YAAAA,IAAI,EAAC;AAAzB,WAAtB;;AACA,eAAKC,WAAL,CAAiBH,IAAjB,CAAsB;AAACC,YAAAA,GAAG,EAAC,aAAL;AAAoBC,YAAAA,IAAI,EAAC;AAAzB,WAAtB;;AAGA;AAAA;AAAA,oCAASE,EAAT,CAAY,iBAAZ,EAA+B,KAAKC,aAApC,EAAmD,IAAnD;AACA;AAAA;AAAA,oCAASD,EAAT,CAAY,kBAAZ,EAAgC,KAAKE,cAArC,EAAqD,IAArD;AAEA;AAAA;AAAA,oCAASF,EAAT,CAAY,qBAAZ,EAAmC,KAAKG,iBAAxC,EAA2D,IAA3D;AACA;AAAA;AAAA,oCAASH,EAAT,CAAY,eAAZ,EAA6B,KAAKI,YAAlC,EAAgD,IAAhD;AAGA;AAAA;AAAA,oCAASJ,EAAT,CAAY,mBAAZ,EAAiC,KAAKK,eAAtC,EAAuD,IAAvD;AACA;AAAA;AAAA,oCAASL,EAAT,CAAY,kBAAZ,EAAgC,KAAKM,aAArC,EAAoD,IAApD;AACA;AAAA;AAAA,oCAASN,EAAT,CAAY,kBAAZ,EAAgC,KAAKO,cAArC,EAAqD,IAArD;AACA;AAAA;AAAA,oCAASP,EAAT,CAAY,qBAAZ,EAAmC,KAAKQ,iBAAxC,EAA2D,IAA3D;AACA;AAAA;AAAA,oCAASR,EAAT,CAAY,qBAAZ,EAAmC,KAAKS,kBAAxC,EAA4D,IAA5D;AACA;AAAA;AAAA,oCAAST,EAAT,CAAY,kBAAZ,EAAgC,KAAKU,SAArC,EAAgD,IAAhD;AACA;AAAA;AAAA,oCAASV,EAAT,CAAY,YAAZ,EAA0B,KAAKW,UAA/B,EAA2C,IAA3C;AACA;AAAA;AAAA,oCAASX,EAAT,CAAY,kBAAZ,EAAgC,KAAKY,YAArC,EAAmD,IAAnD;AACA;AAAA;AAAA,oCAASZ,EAAT,CAAY,sBAAZ,EAAoC,KAAKa,oBAAzC,EAA+D,IAA/D;AACA;AAAA;AAAA,oCAASb,EAAT,CAAY,qBAAZ,EAAmC,KAAKc,mBAAxC,EAA6D,IAA7D;AACA;AAAA;AAAA,oCAASd,EAAT,CAAY,cAAZ,EAA4B,KAAKe,WAAjC,EAA8C,IAA9C;AACA;AAAA;AAAA,oCAASf,EAAT,CAAY,YAAZ,EAA0B,KAAKgB,WAA/B,EAA4C,IAA5C;AACA;AAAA;AAAA,oCAAShB,EAAT,CAAY,aAAZ,EAA2B,KAAKiB,YAAhC,EAA8C,IAA9C;AACA;AAAA;AAAA,oCAASjB,EAAT,CAAY,gBAAZ,EAA8B,KAAKkB,eAAnC,EAAoD,IAApD;AAIA,eAAKZ,aAAL;AACA,eAAKa,UAAL;AACA,cAAIC,OAAO,GAAG;AAAA;AAAA,wCAAWC,WAAX,GAAyBC,SAAzB,CAAmCC,SAAjD;;AACA,cAAIH,OAAO,GAAG,CAAd,EAAiB;AACb;AAAA;AAAA,8CAAaC,WAAb,GAA2BG,cAA3B,CAA0CJ,OAA1C;AACH;AACJ;;AAEST,QAAAA,UAAU,GAAS;AACzB,eAAKc,OAAL,CAAa,WAAb,EAAyB,YAAY;AACjC;AAAA;AAAA,sCAASC,IAAT,CAAc,aAAd;AACH,WAFD;AAGH;;AAESD,QAAAA,OAAO,CAACE,IAAD,EAAcC,KAAd,EAAmC;AAChD,cAAI,KAAKC,WAAL,IAAoB,IAAxB,EAA6B;AACzB,iBAAKA,WAAL,GAAmB1D,WAAW,CAAC,KAAK2D,MAAN,CAA9B;AACA,iBAAKD,WAAL,CAAiBE,MAAjB,GAA0B,KAAKC,WAA/B;AACH,WAHD,MAGK;AACD,iBAAKH,WAAL,CAAiBI,MAAjB,GAA0B,IAA1B;AACH;;AACD,eAAKJ,WAAL,CAAiBK,eAAjB,CAAiC,KAAKC,QAAL,EAAjC;;AACA,eAAKN,WAAL,CAAiBO,YAAjB;AAAA;AAAA,gCAAsCT,IAAtC,CAA2CA,IAA3C;;AACA,eAAKE,WAAL,CAAiBO,YAAjB;AAAA;AAAA,gCAAsCC,QAAtC,CAA+CT,KAA/C;AACH;;AAGSU,QAAAA,SAAS,GAAS;AACxB,eAAKC,YAAL;AACA;AAAA;AAAA,4CAAalB,WAAb,GAA2BmB,KAA3B,CAAiCC,SAAjC;AACA;AAAA;AAAA,oCAASC,SAAT,CAAmB,IAAnB;AAEAC,UAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACH;;AAESC,QAAAA,MAAM,GAAS;AACrB;AAAA;AAAA,4CAAaxB,WAAb,GAA2ByB,cAA3B;AACH;;AAGSP,QAAAA,YAAY,GAAS;AAC3B,eAAKQ,aAAL,GAAqB,IAArB;AACA,eAAKC,YAAL,GAAoB,IAApB;AACA,eAAKC,cAAL,GAAsB,IAAtB;AACA,eAAKC,kBAAL,GAA0B,IAA1B;AACA,eAAKC,eAAL,GAAuB,IAAvB;AACA,eAAKC,gBAAL,GAAwB,IAAxB;AACA,eAAKC,SAAL,GAAiB,IAAjB;AACA,eAAKC,eAAL,GAAuB,IAAvB;AACA,eAAKC,eAAL,GAAuB,IAAvB;AACA,eAAK1B,WAAL,GAAmB,IAAnB;AACH;;AAIMM,QAAAA,QAAQ,GAAU;AACrB,iBAAO,KAAKH,WAAL,CAAiBwB,QAAjB,CAA0BC,MAA1B,GAAiC,CAAxC;AACH;AACD;AACJ;AACA;;;AACcrD,QAAAA,YAAY,CAACsD,IAAD,EAAkB;AACpC,cAAI,KAAKX,aAAL,IAAsB,IAA1B,EAAgC;AAC5B,iBAAKA,aAAL,GAAqB5E,WAAW,CAAC,KAAKwF,cAAN,CAAhC;AACA,iBAAKZ,aAAL,CAAmBhB,MAAnB,GAA4B,KAAKC,WAAjC;AACH,WAHD,MAGO;AACH,iBAAKe,aAAL,CAAmBd,MAAnB,GAA4B,IAA5B;AACH;;AACD,eAAKc,aAAL,CAAmBb,eAAnB,CAAmC,KAAKC,QAAL,EAAnC;;AACA,eAAKY,aAAL,CAAmBX,YAAnB;AAAA;AAAA,sDAAmDwB,OAAnD,CAA2DF,IAA3D;AACH;;AAESrD,QAAAA,eAAe,CAACwD,MAAD,EAAiBC,KAAjB,EAAsC;AAC3D,cAAI,KAAKV,gBAAL,IAAyB,IAA7B,EAAmC;AAC/B,iBAAKA,gBAAL,GAAwBjF,WAAW,CAAC,KAAK4F,iBAAN,CAAnC;AACA,iBAAKX,gBAAL,CAAsBrB,MAAtB,GAA+B,KAAKC,WAApC;AACH,WAHD,MAGO;AACH,iBAAKoB,gBAAL,CAAsBnB,MAAtB,GAA+B,IAA/B;AACH;;AACD,eAAKmB,gBAAL,CAAsBlB,eAAtB,CAAsC,KAAKC,QAAL,EAAtC;;AACA,eAAKiB,gBAAL,CAAsBhB,YAAtB;AAAA;AAAA,4DAAyDwB,OAAzD,CAAiEC,MAAjE,EAAyEC,KAAzE;AACH;AACD;AACJ;AACA;;;AACc/C,QAAAA,WAAW,CAAC2C,IAAD,EAAiBM,IAAY,GAAG,CAAhC,EAAmCC,QAAgB,GAAG,CAAtD,EAAyDC,MAAc,GAAG,CAA1E,EAAmF;AACpG,cAAI,KAAKlB,YAAL,IAAqB,IAAzB,EAA+B;AAC3B,iBAAKA,YAAL,GAAoB7E,WAAW,CAAC,KAAKgG,aAAN,CAA/B;AACA,iBAAKnB,YAAL,CAAkBjB,MAAlB,GAA2B,KAAKC,WAAhC;AACH,WAHD,MAGO;AACH,iBAAKgB,YAAL,CAAkBf,MAAlB,GAA2B,IAA3B;AACH;;AACD,eAAKe,YAAL,CAAkBd,eAAlB,CAAkC,KAAKC,QAAL,EAAlC;;AACA,eAAKa,YAAL,CAAkBZ,YAAlB;AAAA;AAAA,oDAAiDwB,OAAjD,CAAyDF,IAAzD,EAA+DM,IAA/D,EAAqEC,QAArE;AACH;AAGD;AACJ;AACA;AACA;AACA;;;AACczD,QAAAA,iBAAiB,CAACkD,IAAD,EAAiBO,QAAgB,GAAG,CAApC,EAA6C;AACpE,eAAKlD,WAAL,CAAiB2C,IAAjB,EAAuB,CAAvB,EAA0BO,QAA1B,EAAoC,CAApC;AACH;AAED;;;AACUxD,QAAAA,kBAAkB,CAAC2D,GAAD,EAAcC,CAAd,EAAyBC,CAAzB,EAA0C;AAClE,cAAI,KAAKnB,eAAL,IAAwB,IAA5B,EAAkC;AAC9B,iBAAKA,eAAL,GAAuBhF,WAAW,CAAC,KAAKoG,gBAAN,CAAlC;AACA,iBAAKpB,eAAL,CAAqBpB,MAArB,GAA8B,KAAKyC,IAAnC;AACH,WAHD,MAGO;AACH,iBAAKrB,eAAL,CAAqBlB,MAArB,GAA8B,IAA9B;AACH;;AACD,eAAKkB,eAAL,CAAqBjB,eAArB,CAAqC,KAAKC,QAAL,EAArC;;AACA,eAAKgB,eAAL,CAAqBf,YAArB;AAAA;AAAA,0DAAuDwB,OAAvD,CAA+DQ,GAA/D,EAAoEC,CAApE,EAAuEC,CAAvE;AACH;AAGD;AACJ;AACA;;;AACc/D,QAAAA,cAAc,CAACkE,OAAD,EAAeC,OAAf,EAAmC;AACvD,cAAI,KAAKnB,eAAL,IAAwB,IAA5B,EAAkC;AAC9B,iBAAKA,eAAL,GAAuBpF,WAAW,CAAC,KAAKwG,gBAAN,CAAlC;AACA,iBAAKpB,eAAL,CAAqBxB,MAArB,GAA8B,KAAKC,WAAnC;AACH,WAHD,MAGO;AACH,iBAAKuB,eAAL,CAAqBtB,MAArB,GAA8B,IAA9B;AACH;;AACD,eAAKsB,eAAL,CAAqBrB,eAArB,CAAqC,KAAKC,QAAL,EAArC;;AACA,eAAKoB,eAAL,CAAqBnB,YAArB;AAAA;AAAA,oDAAoDwB,OAApD,CAA4Da,OAA5D,EAAqEC,OAArE;AACH;AAGD;AACJ;AACA;;;AACczE,QAAAA,aAAa,CAACyD,IAAD,EAAkB;AACrC,cAAI,KAAKT,cAAL,IAAuB,IAA3B,EAAiC;AAC7B,iBAAKA,cAAL,GAAsB9E,WAAW,CAAC,KAAKyG,eAAN,CAAjC;AACA,iBAAK3B,cAAL,CAAoBlB,MAApB,GAA6B,KAAKC,WAAlC;AACH,WAHD,MAGO;AACH,iBAAKiB,cAAL,CAAoBhB,MAApB,GAA6B,IAA7B;AACH;;AAED,eAAKgB,cAAL,CAAoBf,eAApB,CAAoC,KAAKC,QAAL,EAApC;;AACA,eAAK0C,UAAL,CAAgB5C,MAAhB,GAAyB,KAAzB;AACA;AAAA;AAAA,oCAASP,IAAT,CAAc,eAAd,EAA+BgC,IAAI,CAACW,CAApC,EAAuCX,IAAI,CAACY,CAA5C;;AACA,eAAKrB,cAAL,CAAoBb,YAApB;AAAA;AAAA,gDAAiDwB,OAAjD,CAAyDF,IAAzD;AACH;;AAESxD,QAAAA,cAAc,GAAS;AAC7B,eAAK2E,UAAL,CAAgB5C,MAAhB,GAAyB,IAAzB;AACH;;AAES9B,QAAAA,iBAAiB,CAACuD,IAAD,EAAkB;AACzC,cAAI,KAAKR,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,iBAAKA,kBAAL,GAA0B/E,WAAW,CAAC,KAAK2G,mBAAN,CAArC;AACA,iBAAK5B,kBAAL,CAAwBnB,MAAxB,GAAiC,KAAKC,WAAtC;AACH,WAHD,MAGO;AACH,iBAAKkB,kBAAL,CAAwBjB,MAAxB,GAAiC,IAAjC;AACH;;AACD,eAAKiB,kBAAL,CAAwBhB,eAAxB,CAAwC,KAAKC,QAAL,EAAxC;;AACA,eAAKe,kBAAL,CAAwBd,YAAxB;AAAA;AAAA,8CAAoDwB,OAApD,CAA4DF,IAA5D;AACH;AAID;AACJ;AACA;;;AACcqB,QAAAA,aAAa,GAAS;AAC5B,cAAI,KAAKC,cAAL,IAAuB,IAA3B,EAAiC;AAC7B,iBAAKA,cAAL,GAAsB7G,WAAW,CAAC,KAAK8G,eAAN,CAAjC;AACA,iBAAKD,cAAL,CAAoBjD,MAApB,GAA6B,KAAKC,WAAlC;AACH,WAHD,MAGO;AACH,iBAAKgD,cAAL,CAAoB/C,MAApB,GAA6B,IAA7B;AACH;;AACD,eAAK+C,cAAL,CAAoB9C,eAApB,CAAoC,KAAKC,QAAL,EAApC;;AACA,eAAK6C,cAAL,CAAoB5C,YAApB;AAAA;AAAA,gDAAiD8C,UAAjD;AACH;AAED;AACJ;AACA;;;AACc5E,QAAAA,aAAa,GAAS;AAC5B,cAAIkD,QAAQ,GAAG,KAAK2B,WAAL,CAAiBX,IAAjB,CAAsBhB,QAArC;AACA,cAAI4B,OAAO,GAAG;AAAA;AAAA,4CAAa/D,WAAb,GAA2BmB,KAA3B,CAAiC6C,cAAjC,EAAd;AAEA,cAAIC,CAAC,GAAG,CAAR;AACA9B,UAAAA,QAAQ,CAAC8B,CAAD,CAAR,CAAYC,cAAZ,CAA2B,WAA3B,EAAwCnD,YAAxC,CAAqDlE,KAArD,EAA4DsH,MAA5D,GAAqE,QAAQ;AAAA;AAAA,8BAAMC,YAAN,CAAmBL,OAAO,CAAC,QAAD,CAA1B,CAA7E;AACAE,UAAAA,CAAC,IAAE,CAAH;;AAGA,eAAK,IAAII,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAK/F,SAAL,CAAe8D,MAA3C,EAAmDiC,KAAK,EAAxD,EAA4D;AACxD,kBAAMC,GAAG,GAAG,KAAKhG,SAAL,CAAe+F,KAAf,CAAZ;AACA,gBAAIE,KAAK,GAAGpC,QAAQ,CAAC8B,CAAD,CAAR,CAAYC,cAAZ,CAA2B,WAA3B,EAAwCnD,YAAxC,CAAqDlE,KAArD,CAAZ;;AAEA,gBAAGyH,GAAG,CAAC9F,GAAJ,IAAW,MAAd,EAAqB;AACjB+F,cAAAA,KAAK,CAACJ,MAAN,GAAeG,GAAG,CAAC7F,IAAJ,GAAW;AAAA;AAAA,kCAAM2F,YAAN,CAAmBL,OAAO,CAACO,GAAG,CAAC9F,GAAL,CAA1B,CAA1B;AACH,aAFD,MAEK;AACD+F,cAAAA,KAAK,CAACJ,MAAN,GAAeG,GAAG,CAAC7F,IAAJ,GAAW;AAAA;AAAA,kCAAM2F,YAAN,CAAmBL,OAAO,CAACO,GAAG,CAAC9F,GAAL,CAA1B,CAAX,GAAkD,GAAlD,GAAwD;AAAA;AAAA,kCAAM4F,YAAN,CAAmBL,OAAO,CAAC,gBAAD,CAA1B,CAAvE;AACH;;AAEDE,YAAAA,CAAC,IAAE,CAAH;AACH;;AAED,eAAK,IAAII,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAK3F,WAAL,CAAiB0D,MAA7C,EAAqDiC,KAAK,EAA1D,EAA8D;AAC1D,kBAAMC,GAAG,GAAG,KAAK5F,WAAL,CAAiB2F,KAAjB,CAAZ;AACA,gBAAIE,KAAK,GAAGpC,QAAQ,CAAC8B,CAAD,CAAR,CAAYC,cAAZ,CAA2B,WAA3B,EAAwCnD,YAAxC,CAAqDlE,KAArD,CAAZ;AACA0H,YAAAA,KAAK,CAACJ,MAAN,GAAeG,GAAG,CAAC7F,IAAJ,GAAW;AAAA;AAAA,gCAAM2F,YAAN,CAAmBL,OAAO,CAACO,GAAG,CAAC9F,GAAL,CAA1B,CAA1B;AACAyF,YAAAA,CAAC,IAAE,CAAH;AACH;AAEJ;AAID;AACJ;AACA;;;AACcO,QAAAA,QAAQ,GAAS;AACvB,cAAI,KAAKxC,SAAL,IAAkB,IAAtB,EAA4B;AACxB,iBAAKA,SAAL,GAAiBlF,WAAW,CAAC,KAAK2H,UAAN,CAA5B;AACA,iBAAKzC,SAAL,CAAetB,MAAf,GAAwB,KAAKC,WAA7B;AACH,WAHD,MAGO;AACH,iBAAKqB,SAAL,CAAepB,MAAf,GAAwB,IAAxB;AACH;;AACD,eAAKoB,SAAL,CAAenB,eAAf,CAA+B,KAAKC,QAAL,EAA/B;AACH;AAKD;AACJ;AACA;AACA;;;AACczB,QAAAA,SAAS,CAACgD,IAAD,EAAkB;AACjC,cAAI,KAAKJ,eAAL,IAAwB,IAA5B,EAAkC;AAC9B,iBAAKA,eAAL,GAAuBnF,WAAW,CAAC,KAAK4H,eAAN,CAAlC;AACA,iBAAKzC,eAAL,CAAqBvB,MAArB,GAA8B,KAAKC,WAAnC;AACH,WAHD,MAGO;AACH,iBAAKsB,eAAL,CAAqBrB,MAArB,GAA8B,IAA9B;AACH;;AACD,eAAKqB,eAAL,CAAqBpB,eAArB,CAAqC,KAAKC,QAAL,EAArC;;AACA,eAAKmB,eAAL,CAAqBlB,YAArB;AAAA;AAAA,wCAA8CwB,OAA9C,CAAsDF,IAAtD;;AAEAf,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B,KAAKZ,WAA/B;AACH;;AAISgE,QAAAA,SAAS,GAAS;AACxB,cAAI,KAAKC,UAAL,IAAmB,IAAvB,EAA6B;AACzB,iBAAKA,UAAL,GAAkB9H,WAAW,CAAC,KAAK+H,WAAN,CAA7B;AACA,iBAAKD,UAAL,CAAgBlE,MAAhB,GAAyB,KAAKC,WAA9B;AACH,WAHD,MAGO;AACH,iBAAKiE,UAAL,CAAgBhE,MAAhB,GAAyB,IAAzB;AACH;;AACD,eAAKgE,UAAL,CAAgB/D,eAAhB,CAAgC,KAAKC,QAAL,EAAhC;AACH;;AAGSgE,QAAAA,QAAQ,GAAS;AACvB,cAAI,KAAKC,SAAL,IAAkB,IAAtB,EAA4B;AACxB,iBAAKA,SAAL,GAAiBjI,WAAW,CAAC,KAAKkI,UAAN,CAA5B;AACA,iBAAKD,SAAL,CAAerE,MAAf,GAAwB,KAAKC,WAA7B;AACH,WAHD,MAGO;AACH,iBAAKoE,SAAL,CAAenE,MAAf,GAAwB,IAAxB;AACH;;AACD,eAAKmE,SAAL,CAAelE,eAAf,CAA+B,KAAKC,QAAL,EAA/B;AACH;;AAISmE,QAAAA,MAAM,GAAS;AACrB,cAAI,KAAKC,cAAL,IAAuB,IAA3B,EAAiC;AAC7B,iBAAKA,cAAL,GAAsBpI,WAAW,CAAC,KAAKqI,eAAN,CAAjC;AACA,iBAAKD,cAAL,CAAoBxE,MAApB,GAA6B,KAAKC,WAAlC;AACH,WAHD,MAGO;AACH,iBAAKuE,cAAL,CAAoBtE,MAApB,GAA6B,IAA7B;AACH;;AACD,eAAKsE,cAAL,CAAoBrE,eAApB,CAAoC,KAAKC,QAAL,EAApC;;AACA,eAAKoE,cAAL,CAAoBnE,YAApB;AAAA;AAAA,gDAAiDqE,QAAjD;AACH;;AAES5F,QAAAA,oBAAoB,GAAS;AACnC8B,UAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;;AACA,cAAI,KAAK8D,mBAAL,IAA4B,IAAhC,EAAsC;AAClC,iBAAKA,mBAAL,GAA2BvI,WAAW,CAAC,KAAKwI,oBAAN,CAAtC;AACA,iBAAKD,mBAAL,CAAyB3E,MAAzB,GAAkC,KAAKC,WAAvC;AAEH,WAJD,MAIO;AACH,iBAAK0E,mBAAL,CAAyBzE,MAAzB,GAAkC,IAAlC;AACH;;AAED,eAAKyE,mBAAL,CAAyBxE,eAAzB,CAAyC,KAAKC,QAAL,EAAzC;AAEH;;AAESrB,QAAAA,mBAAmB,GAAS;AAClC6B,UAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;;AACA,cAAI,KAAKgE,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,iBAAKA,kBAAL,GAA0BzI,WAAW,CAAC,KAAK0I,mBAAN,CAArC;AACA,iBAAKD,kBAAL,CAAwB7E,MAAxB,GAAiC,KAAKC,WAAtC;AACH,WAHD,MAGO;AACH,iBAAK4E,kBAAL,CAAwB3E,MAAxB,GAAiC,IAAjC;AACH;;AACD,eAAK2E,kBAAL,CAAwB1E,eAAxB,CAAwC,KAAKC,QAAL,EAAxC;AAEH;;AAED2E,QAAAA,eAAe,GAAQ;AACnB,eAAK9F,WAAL,CAAiB,CAAjB;AACH;;AAESA,QAAAA,WAAW,CAACgD,IAAW,GAAC,CAAb,EAAgB+C,OAAmB,GAAG,IAAtC,EAA4CC,QAAe,GAAC,CAAC,CAA7D,EAAsE;AACvFrE,UAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BoB,IAA3B,EAAiC+C,OAAjC,EAA0CC,QAA1C;;AACA,cAAI,KAAKC,UAAL,IAAmB,IAAvB,EAA6B;AACzB,iBAAKA,UAAL,GAAkB9I,WAAW,CAAC,KAAK+I,WAAN,CAA7B;AACA,iBAAKD,UAAL,CAAgBlF,MAAhB,GAAyB,KAAKC,WAA9B;AACH,WAHD,MAGO;AACH,iBAAKiF,UAAL,CAAgBhF,MAAhB,GAAyB,IAAzB;AACH;;AACD,eAAKgF,UAAL,CAAgB/E,eAAhB,CAAgC,KAAKC,QAAL,EAAhC;;AACA,eAAK8E,UAAL,CAAgB7E,YAAhB;AAAA;AAAA,wCAAyCwB,OAAzC,CAAiDI,IAAjD,EAAuD+C,OAAvD,EAAgEC,QAAhE;AACH;;AAES/F,QAAAA,YAAY,GAAE;AACpB,cAAI,KAAKgG,UAAT,EAAqB;AAClB,iBAAKA,UAAL,CAAgBhF,MAAhB,GAAyB,KAAzB;AACF;AACJ;;AAESf,QAAAA,eAAe,CAACiG,GAAD,EAAgBnD,IAAW,GAAC,CAA5B,EAA+B+C,OAAmB,GAAG,IAArD,EAA2DC,QAAe,GAAC,CAAC,CAA5E,EAA8E;AACnGrE,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BuE,GAA/B,EAAoCnD,IAApC,EAA0C+C,OAA1C,EAAmDC,QAAnD;;AACA,cAAI,KAAKI,cAAL,IAAuB,IAA3B,EAAiC;AAC7B,iBAAKA,cAAL,GAAsBjJ,WAAW,CAAC,KAAKkJ,eAAN,CAAjC;AACA,iBAAKD,cAAL,CAAoBrF,MAApB,GAA6B,KAAKC,WAAlC;AACH,WAHD,MAGO;AACH,iBAAKoF,cAAL,CAAoBnF,MAApB,GAA6B,IAA7B;AACH;;AACD,eAAKmF,cAAL,CAAoBlF,eAApB,CAAoC,KAAKC,QAAL,EAApC;;AACA,eAAKiF,cAAL,CAAoBhF,YAApB;AAAA;AAAA,gDAAiDwB,OAAjD,CAAyDuD,GAAzD,EAA8DnD,IAA9D,EAAoE+C,OAApE,EAA6EC,QAA7E;AACH,SA/d6C,CAke9C;;;AACUpG,QAAAA,YAAY,CAAC0G,GAAD,EAAc;AAChC,eAAK7F,OAAL,CAAa,WAAS6F,GAAG,CAACC,IAAb,GAAkB,KAA/B,EAAsC,IAAtC;AACH;;AAESpG,QAAAA,UAAU,GAAS;AACzB,cAAIqG,QAAQ,GAAG;AAAA;AAAA,4CAAanG,WAAb,GAA2BmB,KAA3B,CAAiCiF,WAAjC,EAAf;AACA,eAAKC,SAAL,CAAelC,MAAf,GAAwB,SAASgC,QAAQ,CAACG,QAA1C;AACA,eAAKC,QAAL,CAAcpC,MAAd,GAAuB,WAAWgC,QAAQ,CAACK,GAApB,GAA0B,EAAjD;AACH;;AAESC,QAAAA,iBAAiB,GAAQ;AAC/B,cAAG,KAAKC,YAAL,IAAqB,IAAxB,EAA6B;AACzB,iBAAKA,YAAL,GAAoB5J,WAAW,CAAC,KAAK6J,aAAN,CAA/B;AACA,iBAAKD,YAAL,CAAkBhG,MAAlB,GAA2B,KAAKC,WAAhC;AACH;;AACD,eAAK+F,YAAL,CAAkB9F,MAAlB,GAA2B,IAA3B;;AACA,eAAK8F,YAAL,CAAkB7F,eAAlB,CAAkC,KAAKC,QAAL,EAAlC;AAEH;;AArf6C,O;;;;;iBAG3B,I;;;;;;;iBAGM,I;;;;;;;iBAIG,I;;;;;;;iBAIX,I;;;;;;;iBAIO,I;;;;;;;iBAIG,I;;;;;;;iBAID,I;;;;;;;iBAII,I;;;;;;;iBAIJ,I;;;;;;;iBAGC,I;;;;;;;iBAIN,I;;;;;;;iBAIK,I;;;;;;;iBAIJ,I;;;;;;;iBAID,I;;;;;;;iBAIG,I;;;;;;;iBAKE,I;;;;;;;iBAIK,I;;;;;;;iBAID,I;;;;;;;iBAIR,I;;;;;;;iBAII,I;;;;;;;iBAIP,I;;;;;;;iBAGG,I;;;;;;;iBAGH,I;;;;;;;iBAGD,I","sourcesContent":["import { _decorator, Component, Prefab, Node, Layout, Label, instantiate, UITransform } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport LoginCommand from \"../../login/LoginCommand\";\nimport ArmySelectNodeLogic from \"./ArmySelectNodeLogic\";\nimport CityArmySettingLogic from \"./CityArmySettingLogic\";\nimport FacilityListLogic from \"./FacilityListLogic\";\nimport MapUICommand from \"./MapUICommand\";\nimport Dialog from \"./Dialog\";\nimport UnionCommand from \"../../union/UnionCommand\";\nimport MapCommand from \"../MapCommand\";\nimport FortressAbout from \"./FortressAbout\";\nimport CityAboutLogic from \"./CityAboutLogic\";\nimport GeneralListLogic from \"./GeneralListLogic\";\nimport TransformLogic from \"./TransformLogic\";\nimport { Tools } from \"../../utils/Tools\";\nimport GeneralInfoLogic from \"./GeneralInfoLogic\";\nimport WarReportLogic from \"./WarReportLogic\";\nimport DrawRLogic from \"./DrawRLogic\";\nimport { GeneralData } from \"../../general/GeneralProxy\";\nimport SkillLogic from \"./SkillLogic\";\nimport { SkillConf } from \"../../config/skill/Skill\";\nimport SkillInfoLogic from \"./SkillInfoLogic\";\nimport { EventMgr } from '../../utils/EventMgr';\n\n\n\n@ccclass('MapUILogic')\nexport default class MapUILogic extends Component {\n\n    @property(Node)\n    contentNode:Node = null;\n\n    @property(Prefab)\n    facilityPrefab: Prefab = null;\n    protected _facilityNode: Node = null;\n\n    @property(Prefab)\n    armySettingPrefab: Prefab = null;\n    protected _armySettingNode: Node = null;\n\n    @property(Prefab)\n    dialog: Prefab = null;\n    protected _dialogNode: Node = null;\n\n    @property(Prefab)\n    generalPrefab: Prefab = null;\n    protected _generalNode: Node = null;\n\n    @property(Prefab)\n    generalDesPrefab: Prefab = null;\n    protected _generalDesNode: Node = null;\n\n    @property(Prefab)\n    cityAboutPrefab: Prefab = null;\n    protected _cityAboutNode: Node = null;\n\n    @property(Prefab)\n    fortressAboutPrefab: Prefab = null;\n    protected _fortressAboutNode: Node = null;\n\n    @property(Prefab)\n    warReportPrefab: Prefab = null;\n    protected _warReportNode: Node = null;\n    @property(Prefab)\n    armySelectPrefab: Prefab = null;\n    protected _armySelectNode: Node = null;\n\n    @property(Prefab)\n    drawPrefab: Prefab = null;\n    protected _drawNode: Node = null;\n\n    @property(Prefab)\n    drawResultrefab: Prefab = null;\n    protected _drawResultNode: Node = null;\n    \n    @property(Prefab)\n    unionPrefab: Prefab = null;\n    protected _unionNode: Node = null;\n\n    @property(Prefab)\n    chatPrefab: Prefab = null;\n    protected _chatNode: Node = null;\n\n    @property(Prefab)\n    collectPrefab: Prefab = null;\n    protected _collectNode: Node = null;\n\n\n    @property(Prefab)\n    transFormPrefab: Prefab = null;\n    protected _transFormNode: Node = null;\n\n    @property(Prefab)\n    generalConvertPrefab: Prefab = null;\n    protected _generalConvertNode: Node = null;\n\n    @property(Prefab)\n    generalRosterPrefab: Prefab = null;\n    protected _generalRosterNode: Node = null;\n\n    @property(Prefab)\n    skillPrefab: Prefab = null;\n    protected _skillNode: Node = null;\n\n    @property(Prefab)\n    skillInfoPrefab: Prefab = null;\n    protected _skillInfoNode: Node = null;\n\n    @property(Node)\n    widgetNode: Node = null;\n\n    @property(Layout)\n    srollLayout: Layout = null;\n\n    @property(Label)\n    nameLabel: Label = null;\n\n    @property(Label)\n    ridLabel: Label = null;\n\n    protected _resArray: any = [];\n    protected _yieldArray: any = [];\n\n    protected onLoad(): void {\n\n        this._resArray.push({key:\"grain\", name:\"谷:\"});\n        this._resArray.push({key:\"wood\", name:\"木:\"});\n        this._resArray.push({key:\"iron\", name:\"铁:\"});\n        this._resArray.push({key:\"stone\", name:\"石:\"});\n        this._resArray.push({key:\"gold\", name:\"钱:\"});\n\n        this._yieldArray.push({key:\"wood_yield\", name:\"木+\"});\n        this._yieldArray.push({key:\"iron_yield\", name:\"铁+\"});\n        this._yieldArray.push({key:\"stone_yield\", name:\"石+\"});\n        this._yieldArray.push({key:\"grain_yield\", name:\"谷+\"});\n\n\n        EventMgr.on(\"open_city_about\", this.openCityAbout, this);\n        EventMgr.on(\"close_city_about\", this.closeCityAbout, this);\n\n        EventMgr.on(\"open_fortress_about\", this.openFortressAbout, this);\n        EventMgr.on(\"open_facility\", this.openFacility, this);\n\n\n        EventMgr.on(\"open_army_setting\", this.openArmySetting, this);\n        EventMgr.on(\"upate_my_roleRes\", this.updateRoleRes, this);\n        EventMgr.on(\"open_general_des\", this.openGeneralDes, this);\n        EventMgr.on(\"open_general_choose\", this.openGeneralChoose, this);\n        EventMgr.on(\"open_army_select_ui\", this.onOpenArmySelectUI, this);\n        EventMgr.on(\"open_draw_result\", this.openDrawR, this);\n        EventMgr.on(\"robLoginUI\", this.robLoginUI, this);\n        EventMgr.on(\"interior_collect\", this.onCollection, this);\n        EventMgr.on(\"open_general_convert\", this.onOpenGeneralConvert, this);\n        EventMgr.on(\"open_general_roster\", this.onOpenGeneralRoster, this);\n        EventMgr.on(\"open_general\", this.openGeneral, this);\n        EventMgr.on(\"open_skill\", this.onOpenSkill, this);\n        EventMgr.on(\"close_skill\", this.onCloseSkill, this);\n        EventMgr.on(\"open_skillInfo\", this.onOpenSkillInfo, this);\n        \n        \n\n        this.updateRoleRes();\n        this.updateRole();\n        let unionId = MapCommand.getInstance().cityProxy.myUnionId;\n        if (unionId > 0) {\n            UnionCommand.getInstance().unionApplyList(unionId);\n        }\n    }\n\n    protected robLoginUI(): void {\n        this.showTip(\"账号在其他地方登录\",function () {\n            EventMgr.emit(\"enter_login\");\n        });\n    }\n\n    protected showTip(text:string, close:Function):void {\n        if (this._dialogNode == null){\n            this._dialogNode = instantiate(this.dialog)\n            this._dialogNode.parent = this.contentNode;\n        }else{\n            this._dialogNode.active = true;\n        }\n        this._dialogNode.setSiblingIndex(this.topLayer());\n        this._dialogNode.getComponent(Dialog).text(text);\n        this._dialogNode.getComponent(Dialog).setClose(close)\n    }\n\n\n    protected onDestroy(): void {\n        this.clearAllNode();\n        MapUICommand.getInstance().proxy.clearData();\n        EventMgr.targetOff(this);\n\n        console.log(\"MapUILogic onDestroy\")\n    }\n\n    protected onBack(): void {\n        LoginCommand.getInstance().account_logout();\n    }\n\n\n    protected clearAllNode(): void {\n        this._facilityNode = null;\n        this._generalNode = null;\n        this._cityAboutNode = null;\n        this._fortressAboutNode = null;\n        this._armySelectNode = null;\n        this._armySettingNode = null;\n        this._drawNode = null;\n        this._drawResultNode = null;\n        this._generalDesNode = null;\n        this._dialogNode = null\n    }\n\n\n\n    public topLayer():number {\n        return this.contentNode.children.length+1;\n    }\n    /**\n     * 设施\n     */\n    protected openFacility(data: any): void {\n        if (this._facilityNode == null) {\n            this._facilityNode = instantiate(this.facilityPrefab);\n            this._facilityNode.parent = this.contentNode;\n        } else {\n            this._facilityNode.active = true;\n        }\n        this._facilityNode.setSiblingIndex(this.topLayer());\n        this._facilityNode.getComponent(FacilityListLogic).setData(data);\n    }\n\n    protected openArmySetting(cityId: number, order: number): void {\n        if (this._armySettingNode == null) {\n            this._armySettingNode = instantiate(this.armySettingPrefab);\n            this._armySettingNode.parent = this.contentNode;\n        } else {\n            this._armySettingNode.active = true;\n        }\n        this._armySettingNode.setSiblingIndex(this.topLayer());\n        this._armySettingNode.getComponent(CityArmySettingLogic).setData(cityId, order);\n    }\n    /**\n     * 武将\n     */\n    protected openGeneral(data: number[], type: number = 0, position: number = 0, zIndex: number = 0): void {\n        if (this._generalNode == null) {\n            this._generalNode = instantiate(this.generalPrefab);\n            this._generalNode.parent = this.contentNode;\n        } else {\n            this._generalNode.active = true;\n        }\n        this._generalNode.setSiblingIndex(this.topLayer());\n        this._generalNode.getComponent(GeneralListLogic).setData(data, type, position);\n    }\n\n\n    /**\n     * 武将选择\n     * @param data \n     * @param zIndex \n     */\n    protected openGeneralChoose(data: number[], position: number = 0): void {\n        this.openGeneral(data, 1, position, 1);\n    }\n\n    /**打开军队选择界面*/\n    protected onOpenArmySelectUI(cmd: number, x: number, y: number): void {\n        if (this._armySelectNode == null) {\n            this._armySelectNode = instantiate(this.armySelectPrefab);\n            this._armySelectNode.parent = this.node;\n        } else {\n            this._armySelectNode.active = true;\n        }\n        this._armySelectNode.setSiblingIndex(this.topLayer());\n        this._armySelectNode.getComponent(ArmySelectNodeLogic).setData(cmd, x, y);\n    }\n\n\n    /**\n     * 武将详情\n     */\n    protected openGeneralDes(cfgData: any, curData: any): void {\n        if (this._generalDesNode == null) {\n            this._generalDesNode = instantiate(this.generalDesPrefab);\n            this._generalDesNode.parent = this.contentNode;\n        } else {\n            this._generalDesNode.active = true;\n        }\n        this._generalDesNode.setSiblingIndex(this.topLayer());\n        this._generalDesNode.getComponent(GeneralInfoLogic).setData(cfgData, curData);\n    }\n\n\n    /**\n     * 城市\n     */\n    protected openCityAbout(data: any): void {\n        if (this._cityAboutNode == null) {\n            this._cityAboutNode = instantiate(this.cityAboutPrefab);\n            this._cityAboutNode.parent = this.contentNode;\n        } else {\n            this._cityAboutNode.active = true;\n        }\n\n        this._cityAboutNode.setSiblingIndex(this.topLayer());\n        this.widgetNode.active = false;\n        EventMgr.emit(\"scroll_to_map\", data.x, data.y);\n        this._cityAboutNode.getComponent(CityAboutLogic).setData(data);\n    }\n\n    protected closeCityAbout(): void {\n        this.widgetNode.active = true;\n    }\n    \n    protected openFortressAbout(data: any): void {\n        if (this._fortressAboutNode == null) {\n            this._fortressAboutNode = instantiate(this.fortressAboutPrefab);\n            this._fortressAboutNode.parent = this.contentNode;\n        } else {\n            this._fortressAboutNode.active = true;\n        }\n        this._fortressAboutNode.setSiblingIndex(this.topLayer());\n        this._fortressAboutNode.getComponent(FortressAbout).setData(data);\n    }\n\n    \n\n    /**\n     * 战报\n     */\n    protected openWarReport(): void {\n        if (this._warReportNode == null) {\n            this._warReportNode = instantiate(this.warReportPrefab);\n            this._warReportNode.parent = this.contentNode;\n        } else {\n            this._warReportNode.active = true;\n        }\n        this._warReportNode.setSiblingIndex(this.topLayer());\n        this._warReportNode.getComponent(WarReportLogic).updateView();\n    }\n\n    /**\n     * 角色信息\n     */\n    protected updateRoleRes(): void {\n        var children = this.srollLayout.node.children;\n        var roleRes = LoginCommand.getInstance().proxy.getRoleResData();\n\n        var i = 0;\n        children[i].getChildByName(\"New Label\").getComponent(Label).string = \"令牌:\" + Tools.numberToShow(roleRes[\"decree\"]);\n        i+=1;\n        \n\n        for (let index = 0; index < this._resArray.length; index++) {\n            const obj = this._resArray[index];\n            var label = children[i].getChildByName(\"New Label\").getComponent(Label)\n\n            if(obj.key == \"gold\"){\n                label.string = obj.name + Tools.numberToShow(roleRes[obj.key]);\n            }else{\n                label.string = obj.name + Tools.numberToShow(roleRes[obj.key]) + \"/\" + Tools.numberToShow(roleRes[\"depot_capacity\"]);\n            }\n            \n            i+=1;\n        }\n\n        for (let index = 0; index < this._yieldArray.length; index++) {\n            const obj = this._yieldArray[index];\n            var label = children[i].getChildByName(\"New Label\").getComponent(Label)\n            label.string = obj.name + Tools.numberToShow(roleRes[obj.key]);\n            i+=1;\n        }\n\n    }\n\n\n\n    /**\n     * 抽卡\n     */\n    protected openDraw(): void {\n        if (this._drawNode == null) {\n            this._drawNode = instantiate(this.drawPrefab);\n            this._drawNode.parent = this.contentNode;\n        } else {\n            this._drawNode.active = true;\n        }\n        this._drawNode.setSiblingIndex(this.topLayer());\n    }\n\n\n\n\n    /**\n     * 抽卡结果\n     * @param data \n     */\n    protected openDrawR(data: any): void {\n        if (this._drawResultNode == null) {\n            this._drawResultNode = instantiate(this.drawResultrefab);\n            this._drawResultNode.parent = this.contentNode;\n        } else {\n            this._drawResultNode.active = true;\n        }\n        this._drawResultNode.setSiblingIndex(this.topLayer());\n        this._drawResultNode.getComponent(DrawRLogic).setData(data);\n\n        console.log(\"openDrawR:\", this.contentNode);\n    }\n\n\n\n    protected openUnion(): void {\n        if (this._unionNode == null) {\n            this._unionNode = instantiate(this.unionPrefab);\n            this._unionNode.parent = this.contentNode;\n        } else {\n            this._unionNode.active = true;\n        }\n        this._unionNode.setSiblingIndex(this.topLayer());\n    }\n\n\n    protected openChat(): void {\n        if (this._chatNode == null) {\n            this._chatNode = instantiate(this.chatPrefab);\n            this._chatNode.parent = this.contentNode;\n        } else {\n            this._chatNode.active = true;\n        }\n        this._chatNode.setSiblingIndex(this.topLayer());\n    }\n\n\n\n    protected openTr(): void {\n        if (this._transFormNode == null) {\n            this._transFormNode = instantiate(this.transFormPrefab);\n            this._transFormNode.parent = this.contentNode;\n        } else {\n            this._transFormNode.active = true;\n        }\n        this._transFormNode.setSiblingIndex(this.topLayer());\n        this._transFormNode.getComponent(TransformLogic).initView();\n    }\n\n    protected onOpenGeneralConvert(): void {\n        console.log(\"onOpenGeneralConvert\");\n        if (this._generalConvertNode == null) {\n            this._generalConvertNode = instantiate(this.generalConvertPrefab);\n            this._generalConvertNode.parent = this.contentNode;\n            \n        } else {\n            this._generalConvertNode.active = true;\n        }\n\n        this._generalConvertNode.setSiblingIndex(this.topLayer());\n\n    }\n\n    protected onOpenGeneralRoster(): void {\n        console.log(\"onOpenGeneralRoster\");\n        if (this._generalRosterNode == null) {\n            this._generalRosterNode = instantiate(this.generalRosterPrefab);\n            this._generalRosterNode.parent = this.contentNode;\n        } else {\n            this._generalRosterNode.active = true;\n        }\n        this._generalRosterNode.setSiblingIndex(this.topLayer());\n\n    }\n    \n    onClickSkillBtn(): void{\n        this.onOpenSkill(0);\n    }\n\n    protected onOpenSkill(type:number=0, general:GeneralData = null, skillPos:number=-1): void {\n        console.log(\"onOpenSkill\", type, general, skillPos);\n        if (this._skillNode == null) {\n            this._skillNode = instantiate(this.skillPrefab);\n            this._skillNode.parent = this.contentNode;\n        } else {\n            this._skillNode.active = true;\n        }\n        this._skillNode.setSiblingIndex(this.topLayer());\n        this._skillNode.getComponent(SkillLogic).setData(type, general, skillPos);\n    }\n\n    protected onCloseSkill(){\n        if (this._skillNode) {\n           this._skillNode.active = false;\n        } \n    }\n    \n    protected onOpenSkillInfo(cfg:SkillConf, type:number=0, general:GeneralData = null, skillPos:number=-1){\n        console.log(\"onOpenSkillInfo\", cfg, type, general, skillPos);\n        if (this._skillInfoNode == null) {\n            this._skillInfoNode = instantiate(this.skillInfoPrefab);\n            this._skillInfoNode.parent = this.contentNode;\n        } else {\n            this._skillInfoNode.active = true;\n        }\n        this._skillInfoNode.setSiblingIndex(this.topLayer());\n        this._skillInfoNode.getComponent(SkillInfoLogic).setData(cfg, type, general, skillPos);\n    }\n\n\n    //征收\n    protected onCollection(msg:any):void{\n        this.showTip(\"成功征收到 \"+msg.gold+\" 金币\", null);\n    }\n\n    protected updateRole(): void {\n        var roleData = LoginCommand.getInstance().proxy.getRoleData();\n        this.nameLabel.string = \"昵称: \" + roleData.nickName;\n        this.ridLabel.string = \"角色ID: \" + roleData.rid + \"\";\n    }\n\n    protected onClickCollection():void {\n        if(this._collectNode == null){\n            this._collectNode = instantiate(this.collectPrefab);\n            this._collectNode.parent = this.contentNode;\n        }\n        this._collectNode.active = true;\n        this._collectNode.setSiblingIndex(this.topLayer());\n\n    }\n\n}\n"]}