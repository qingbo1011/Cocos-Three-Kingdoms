{"version":3,"sources":["file:///D:/git/github/mszlu/games/slg/ms-sg/assets/scripts/map/ui/DrawLogic.ts"],"names":["_decorator","Component","Label","GeneralCommand","LoginCommand","MapUICommand","EventMgr","ccclass","property","DrawLogic","onEnable","on","updateRoleRes","onDisable","targetOff","onClickClose","node","active","commonCfg","getInstance","proxy","getCommonCfg","roleResData","getRoleResData","labelOnce","string","draw_general_cost","gold","labelTen","basic","getBasicGeneral","cnt","getMyActiveGeneralCnt","cntLab","limit","drawGeneralOnce","drawGenerals","drawGeneralTen"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;;AAGzBC,MAAAA,c;;AAEAC,MAAAA,Y;;AACAC,MAAAA,Y;;AACEC,MAAAA,Q,iBAAAA,Q;;;;;;;OANH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;yBASTS,S,WADpBF,OAAO,CAAC,WAAD,C,UAIHC,QAAQ,CAACN,KAAD,C,UAGRM,QAAQ,CAACN,KAAD,C,UAGRM,QAAQ,CAACN,KAAD,C,oCAVb,MACqBO,SADrB,SACuCR,SADvC,CACiD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAanCS,QAAAA,QAAQ,GAAO;AACrB;AAAA;AAAA,oCAASC,EAAT,CAAY,kBAAZ,EAAgC,KAAKC,aAArC,EAAoD,IAApD;AACA;AAAA;AAAA,oCAASD,EAAT,CAAY,oBAAZ,EAAkC,KAAKC,aAAvC,EAAsD,IAAtD;AACA,eAAKA,aAAL;AACH;;AAGSC,QAAAA,SAAS,GAAO;AACtB;AAAA;AAAA,oCAASC,SAAT,CAAmB,IAAnB;AACH;;AAESC,QAAAA,YAAY,GAAS;AAC3B,eAAKC,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACH;;AAGSL,QAAAA,aAAa,GAAO;AAC1B,cAAIM,SAA8B,GAAG;AAAA;AAAA,gDAAeC,WAAf,GAA6BC,KAA7B,CAAmCC,YAAnC,EAArC;AACA,cAAIC,WAAW,GAAG;AAAA;AAAA,4CAAaH,WAAb,GAA2BC,KAA3B,CAAiCG,cAAjC,EAAlB;AACA,eAAKC,SAAL,CAAeC,MAAf,GAAwB,QAAMP,SAAS,CAACQ,iBAAhB,GAAmC,GAAnC,GAAwCJ,WAAW,CAACK,IAA5E;AACA,eAAKC,QAAL,CAAcH,MAAd,GAAuB,QAAMP,SAAS,CAACQ,iBAAV,GAA8B,EAApC,GAAwC,GAAxC,GAA6CJ,WAAW,CAACK,IAAhF;AAEA,cAAIE,KAAK,GAAG;AAAA;AAAA,4CAAaV,WAAb,GAA2BC,KAA3B,CAAiCU,eAAjC,EAAZ;AACA,cAAIC,GAAG,GAAG;AAAA;AAAA,gDAAeZ,WAAf,GAA6BC,KAA7B,CAAmCY,qBAAnC,EAAV;AACA,eAAKC,MAAL,CAAYR,MAAZ,GAAqB,MAAMM,GAAN,GAAY,GAAZ,GAAkBF,KAAK,CAACK,KAAxB,GAAgC,GAArD;AACH;;AAISC,QAAAA,eAAe,GAAO;AAC5B;AAAA;AAAA,gDAAehB,WAAf,GAA6BiB,YAA7B;AACH;;AAESC,QAAAA,cAAc,GAAO;AAC3B;AAAA;AAAA,gDAAelB,WAAf,GAA6BiB,YAA7B,CAA0C,EAA1C;AACH;;AAhD4C,O;;;;;iBAI1B,I;;;;;;;iBAGD,I;;;;;;;iBAGF,I","sourcesContent":["\nimport { _decorator, Component, Label } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport GeneralCommand from \"../../general/GeneralCommand\";\nimport { GeneralCommonConfig } from \"../../general/GeneralProxy\";\nimport LoginCommand from \"../../login/LoginCommand\";\nimport MapUICommand from \"./MapUICommand\";\nimport { EventMgr } from '../../utils/EventMgr';\n\n@ccclass('DrawLogic')\nexport default class DrawLogic extends Component {\n\n\n    @property(Label)\n    labelOnce: Label = null;\n\n    @property(Label)\n    labelTen: Label = null;\n\n    @property(Label)\n    cntLab: Label = null;\n    \n\n    protected onEnable():void{\n        EventMgr.on(\"upate_my_roleRes\", this.updateRoleRes, this);\n        EventMgr.on(\"update_my_generals\", this.updateRoleRes, this);\n        this.updateRoleRes();\n    }\n\n\n    protected onDisable():void{\n        EventMgr.targetOff(this);\n    }\n\n    protected onClickClose(): void {\n        this.node.active = false;\n    }\n\n\n    protected updateRoleRes():void{\n        let commonCfg: GeneralCommonConfig = GeneralCommand.getInstance().proxy.getCommonCfg();\n        var roleResData = LoginCommand.getInstance().proxy.getRoleResData();\n        this.labelOnce.string = \"消耗:\"+commonCfg.draw_general_cost +\"/\"+ roleResData.gold;\n        this.labelTen.string = \"消耗:\"+commonCfg.draw_general_cost * 10 +\"/\"+ roleResData.gold;\n\n        var basic = MapUICommand.getInstance().proxy.getBasicGeneral();\n        var cnt = GeneralCommand.getInstance().proxy.getMyActiveGeneralCnt();\n        this.cntLab.string = \"(\" + cnt + \"/\" + basic.limit + \")\";\n    }\n\n\n\n    protected drawGeneralOnce():void{\n        GeneralCommand.getInstance().drawGenerals();\n    }\n\n    protected drawGeneralTen():void{\n        GeneralCommand.getInstance().drawGenerals(10);\n    }\n\n\n\n}\n"]}